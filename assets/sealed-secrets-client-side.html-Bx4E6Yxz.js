import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,o as e,a}from"./app-AYg0EWYb.js";const n={},l=a(`<h1 id="sealed-secrets-client-side" tabindex="-1"><a class="header-anchor" href="#sealed-secrets-client-side"><span>Sealed Secrets - Client Side</span></a></h1><h2 id="管理k8s中的敏感信息" tabindex="-1"><a class="header-anchor" href="#管理k8s中的敏感信息"><span>管理k8s中的敏感信息</span></a></h2><p>在使用GitOps的持续交付模型中，我们使用Git仓库作为系统状态的唯一来源，但是像数据库密码、API密钥等敏感信息不适合直接存储在Git仓库中，因此我们需要一种更安全的方式来存储这些敏感信息。</p><p>Sealed Secrets的Client Side：<code>kubeseal</code> 使用非对称加密来加密只有控制器才能解密的敏感信息，经过加密的信息才可以安全地存储在Git仓库中。</p><h2 id="安装kubeseal" tabindex="-1"><a class="header-anchor" href="#安装kubeseal"><span>安装kubeseal</span></a></h2><p>下载安装kubeseal：<a href="https://github.com/bitnami-labs/sealed-secrets/releases" target="_blank" rel="noopener noreferrer">kubeseal</a></p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>以下演示使用的是Window系统，因此你可能需要下载darwin并解压后得到exe文件。</p></div><h2 id="添加环境变量" tabindex="-1"><a class="header-anchor" href="#添加环境变量"><span>添加环境变量</span></a></h2><p>将kubeseal所在的目录添加到环境变量中，以便在任何地方都可以使用kubeseal。</p><p>如果你不想添加环境变量，你需要确保在<code>kubeseal.exe</code>所在的目录下执行命令。</p><h2 id="加密敏感信息" tabindex="-1"><a class="header-anchor" href="#加密敏感信息"><span>加密敏感信息</span></a></h2><p>例如，你有这样一份<code>secret.yaml</code>文件，其中的敏感信息字段仅使用base64编码：</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">c2VjcmV0</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  username</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">YWRtaW4=</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Secret</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">example-secret-2</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  namespace</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">mynamespace</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Opaque</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用<code>kubeseal</code>命令对<code>secret.yaml</code>文件进行加密：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubeseal</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> yaml</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> secret.yaml</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> newsecret.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这条命令将读取当前目录下的<code>secret.yaml</code>文件，将加密后的信息写入<code>newsecret.yaml</code>文件中。</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">bitnami.com/v1alpha1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">SealedSecret</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  creationTimestamp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">example-secret-2</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  namespace</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">mynamespace</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  encryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">AgBd5pG60gKTMe5VVsnx1CzYwNQtF4lOfn9FTFSXF12Sg/AtYtEb75Jwk86c149iYblKwIMlTPrEtH3NPQoS7wc8bU5mV6UF2VPAVufrMJErtbneJXDebk2jEaznHUMVWj3WbnnV1zRRLwr9YcZvngC2I1bb9pZgZZuGrDnQiYd2qywriXDNDAb1eJceNVM2xCY3akD9OVO+gXfeF7Whu9LkysrR6gWiARV248JJ6qbqYodZ9zof1Fcv84JPMV/uLbkhdNzP8anC8pWIpvl7YJ7rf8IWZcLhqPwWLYBWn6gT9bZiRw7879DiwmLUrk+4QwlNFCr+uxTZ9SibrRVj/AhOAGSADlkeXkIowpqVWG1iFg4K7Z0ld8y5rndiCeWSyW6Ir7o3I+J/vRfAESBWBZSw86XeH2h9dYNTvoI6cw1aqxBKpHXORzo404SJr02VxOdWxSDBxkfgT9PZrFkJm6yrhXJ4emj1WXm1i2ucF9uFdk9eWEFvKkl8G9wbdFK1Edg3HWexSCPfQvJHjBjOAT27Y/DCDsWkWyGhl/BflwgIoRdQy4S2wW3o3QGmjsIfwZN3dVIgjqkpYLTmeQ1oQ1zkue7mWOJ6dZBBHu7Opg4SEtOa2SHNQ+E/u6AOQJg4ZIUIhgtzL/0Mg4KzqqbonJleu97zG0Ddwx2TDy9GdS8ARiYy6nkCAY/8rStlk8UZf9K65FZky9s=</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    username</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">AgCaA/r5WNC9BqmwzxF7Fj0Xj9rzh9sSnwr8huD6pDHWtMgi5X43r/gMSs6UZrl2k6BylBuYDf2fmgtvqYaThtvV9ozhvIfvIfbRiQtxel5p8+SGD8MWYR1ii2zFdkmGW4hewsQ5LL5ul3G60kQmUh6gWXqtyuAOXykIYioGkeiXQyq6I20DHPXDZyMk15tKMvyNCcYtp8rtAqla1+zNEXj/B46bsAciqCJyOvQmzhIILErJSyo1VIxUulEbZFVbxLIHWTrPruugI7YU6hYKXwerqc94S65+vpKThF9GkHtHF7vIjFuLNODv17zJ6VzNJsZCvbErefwnqWxo+DPmsYMitHyCTPWgi8BK1h2jrlJnoB+EgcIIpHYmop0cfgdOX29+ET39RGQ1KPUPu5ykRHs9cuaQc0WnO5VmpmSNaJ9pBANdtwicHaBGwnX2kicbJCiz/Kq9FHia62hdVh+5YgukxloIsUpxNMOHPqdSb180zia2YEDfS6qxLA6ebhrZQqjKoYY7umYQmF1fM/V4QadQDW26suYMVOrHyOReZ/1JwZQyOwiEU/3macJR8U5OhsWsOS8RzhMXfZdZ0p8ykESDtP1lV5VdPZAR5aZFIu0B2xmSTjLpCDdlgV0z/EvvmMu6YWm/QYB+7bXqCyWPXyqn/oH4QFSIsn0Lxfd74BbYuZcWj1FNUbyUFvpl+/CNEmu5y5ZX4w==</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  template</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      creationTimestamp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">example-secret-2</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      namespace</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">mynamespace</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Opaque</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用kubeseal加密后的内容是安全的，可以放心地提交到Git仓库中。</p>`,18),t=[l];function h(p,k){return e(),i("div",null,t)}const c=s(n,[["render",h],["__file","sealed-secrets-client-side.html.vue"]]),g=JSON.parse(`{"path":"/dump/cloud-native/kubernetes/sealed-secrets-client-side.html","title":"Sealed Secrets - Client Side","lang":"zh-CN","frontmatter":{"description":"Sealed Secrets - Client Side 管理k8s中的敏感信息 在使用GitOps的持续交付模型中，我们使用Git仓库作为系统状态的唯一来源，但是像数据库密码、API密钥等敏感信息不适合直接存储在Git仓库中，因此我们需要一种更安全的方式来存储这些敏感信息。 Sealed Secrets的Client Side：kubeseal 使用...","head":[["meta",{"property":"og:url","content":"https://guoxicheng.top/dump/cloud-native/kubernetes/sealed-secrets-client-side.html"}],["meta",{"property":"og:site_name","content":"Guo's Page"}],["meta",{"property":"og:title","content":"Sealed Secrets - Client Side"}],["meta",{"property":"og:description","content":"Sealed Secrets - Client Side 管理k8s中的敏感信息 在使用GitOps的持续交付模型中，我们使用Git仓库作为系统状态的唯一来源，但是像数据库密码、API密钥等敏感信息不适合直接存储在Git仓库中，因此我们需要一种更安全的方式来存储这些敏感信息。 Sealed Secrets的Client Side：kubeseal 使用..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-06-21T06:52:13.000Z"}],["meta",{"property":"article:modified_time","content":"2024-06-21T06:52:13.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Sealed Secrets - Client Side\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-06-21T06:52:13.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"管理k8s中的敏感信息","slug":"管理k8s中的敏感信息","link":"#管理k8s中的敏感信息","children":[]},{"level":2,"title":"安装kubeseal","slug":"安装kubeseal","link":"#安装kubeseal","children":[]},{"level":2,"title":"添加环境变量","slug":"添加环境变量","link":"#添加环境变量","children":[]},{"level":2,"title":"加密敏感信息","slug":"加密敏感信息","link":"#加密敏感信息","children":[]}],"git":{"createdTime":1708932062000,"updatedTime":1718952733000},"readingTime":{"minutes":1.41,"words":422},"filePathRelative":"dump/cloud-native/kubernetes/sealed-secrets-client-side.md","localizedDate":"2024年2月26日","autoDesc":true,"excerpt":"\\n<h2>管理k8s中的敏感信息</h2>\\n<p>在使用GitOps的持续交付模型中，我们使用Git仓库作为系统状态的唯一来源，但是像数据库密码、API密钥等敏感信息不适合直接存储在Git仓库中，因此我们需要一种更安全的方式来存储这些敏感信息。</p>\\n<p>Sealed Secrets的Client Side：<code>kubeseal</code> 使用非对称加密来加密只有控制器才能解密的敏感信息，经过加密的信息才可以安全地存储在Git仓库中。</p>\\n<h2>安装kubeseal</h2>\\n<p>下载安装kubeseal：<a href=\\"https://github.com/bitnami-labs/sealed-secrets/releases\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">kubeseal</a></p>"}`);export{c as comp,g as data};
